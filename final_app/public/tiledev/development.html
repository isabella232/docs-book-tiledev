<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      Development Steps at Each Level |
    
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  
<script type="text/javascript">
  if (window.location.host === 'docs.pivotal.io') {
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', '']);
    _gaq.push(['_setDomainName', '']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();
  }
</script>

<script type="text/javascript">
  var blackList = ['acceptance'];

  blackList.forEach(function(blackListedEnv) {
    if (document.URL.indexOf(blackListedEnv) > -1 && blackListedEnv != "") {
      $('head').append('<meta name="hashtag" content="PivotalMoment">');
    }
  });
</script>

<!-- CrazyEgg Tracking Script -->
  <script type="text/javascript">
  setTimeout(function(){var a=document.createElement("script");
  var b=document.getElementsByTagName("script")[0];
  a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0055/2990.js?"+Math.floor(new Date().getTime()/3600000);
  a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>

<!-- Munchkin Marketo Script -->
<script type="text/javascript">
  (function() {
    var didInit = false;

    function initMunchkin() {
      if (didInit === false) {
        didInit = true;
        Munchkin.init('625-IUJ-009');
      }
    }

    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
      if (this.readyState == 'complete' || this.readyState == 'loaded') {
        initMunchkin();
      }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
  })();
</script>

</head>

<body class="tiledev tiledev_development has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "";
    </script>

       
    <header class="header header-layout">
      <h1 class="logo">
        <a href="/">Default Book Title</a>
      </h1>
      
      <div class="header-links js-bar-links">
        <div class="btn-menu" data-behavior="MenuMobile"></div>
        
        <div class="header-item">
          
        </div>
        <!--Default search-->
<!--If book needs something different, add a book-search partial to the book's layouts folder-->
<div class="header-item searchbar js-searchbar">
  <a class="search-icon" data-behavior="Search"></a>
  <div class="search-input">
    <div class="search-input-inner" id="docs-search">
        <form method="get" action="/search">
          <input name="q" placeholder="search" class="search-box" />
        </form>
    </div>
  </div>
</div>

      </div>
    </header>



    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="js-sidenav nav-container" role="navigation">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    <ul>

      <li>
        <a href="index.html">PCF Tile Developers Guide</a>
      </li>

      <li class="has_submenu">
        <a href="tile-basics.html">Tile Basics</a>
        <ul>
          <li>
            <a href="cf-concepts.html">How PCF and PCF Services Work</a>
          </li>
          <li>
            <a href="/tiledev/tile-structure.html">How Tiles Work</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <a href="/tiledev/workflow.html">Tile Development Workflow</a>
        <ul>
          <li>
            <a href="/tiledev/overview.html">Service Integration Overview</a>
          </li>
          <li>
            <a href="/tiledev/stages.html">Levels of Integration</a>
          </li>
          <li>
            <a href="/tiledev/development.html">Development Steps at Each Level</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <a href="/tiledev/environments.html">Development Environments</a>
        <ul>
          <li>
            <a href="/tiledev/environments.html#pcfdev">PCF Dev and BOSH Lite</a>
          </li>
          <li>
            <a href="/tiledev/environments.html#pws">PWS or Other Supported CF Infrastructure</a>
          </li>
          <li>
            <a href="/tiledev/environments.html#pcf">PCF with Ops Manager</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <a href="/tiledev/tools.html">Development Tools</a>
        <ul>
          <li>
            <a href="/tiledev/tile-generator.html">Tile Generator</a>
          </li>
          <li>
            <a href="/tiledev/pcf-command.html">pcf Command Line Utility</a>
          </li>
          <li>
            <a href="/tiledev/concourse.html">Concourse CI</a>
          </li>
          <li>
            <a href="/tiledev/sdk.html">Services SDK</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu expanded">
        <a href="/tiledev/roadmap.html">Service Development Roadmap</a>
        <ul>
          <li>
            <a href="/tiledev/roadmap.html#user-provided">Level 1: User-Provided Service</a>
          </li>
          <li class="has_submenu">
            <a href="/tiledev/brokered.html">Level 2: Brokered Service</a>
            <ul>
              <li>
                <a href="/tiledev/service-brokers.html">Service Broker</a>
              </li>
            </ul>
           </li> 
          <li class="has_submenu">
            <a href="/tiledev/managed.html">Level 3: Managed Service</a>
            <ul>
              <li>
                <a href="/tiledev/bosh-release.html">BOSH Releases</a>
              </li>
              <li>
                <a href="/tiledev/tile-errands.html">Errands</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/tiledev/on-demand.html">Level 4: On-Demand Service</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <a href="/tiledev/other-integrations.html">Other Integrations</a>
        <ul>
          <li>
            <a href="/tiledev/bbr-devguide.html">BOSH Backup and Restore</a>
          </li>
          <li>
            <a href="/tiledev/buildpacks.html">Buildpacks</a>
          </li>
          <li class="has_submenu">
            <a href="/tiledev/credhub.html">CredHub</a>
            <ul>
              <li>
                <a href="/tiledev/create-credhub-vars.html">Creating New Variables in CredHub</a>
              </li>
              <li>
                <a href="/tiledev/migrating-credhub-credentials.html">Migrating Existing Credentials to CredHub</a>
              </li>
              <li>
                <a href="/tiledev/get-credhub-vars.html">Fetching Variable Names and Values</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/tiledev/embedded-agents.html">Embedded Agents</a>
          </li>
          <li>
            <a href="/tiledev/nozzle.html">Logs, Metrics, and Nozzles</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/tiledev/tile-documentation.html">Documentation</a>
      </li>

      <li class="has_submenu">
        <a href="/tiledev/publish.html">Publish and Update</a>
        <ul>
          <li>
            <a href="/tiledev/tile-upgrades.html">Tile Upgrades</a>
          </li>
          <li>
            <a href="/tiledev/releases.html">Partner Software Product Release Cycle</a>
          </li>
        </ul>
      </li>


      <li class="has_submenu">
        <a href="/tiledev/reference.html">Reference</a>
        <ul>
          <li>
            <a href="/tiledev/product-template-reference.html">Product Template Reference</a>
          </li>
          <li>
            <a href="/tiledev/property-reference.html">Property Reference</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <a href="/tiledev/release-notes.html">Partners Release Notices</a>
        <ul>
          <li>
            <a href="/tiledev/release-notes-1-12.html">PCF v1.12 Partners Release Notice</a>
          </li>
          <li>
            <a href="/tiledev/release-notes-1-11.html">PCF v1.11 Partners Release Notice</a>
          </li>
          <li>
            <a href="/tiledev/release-notes-1-10.html">PCF v1.10 Partners Release Notice</a>
          </li>
          <li>
            <a href="/tiledev/release-notes-1-9.html">PCF v1.9 Partners Release Notice</a>
          </li>
          <li>
            <a href="/tiledev/release-notes-1-8.html">PCF v1.8 Partners Release Notice</a>
          </li>
          <li>
            <a href="/tiledev/release-notes-1-7.html">PCF v1.7 Partners Release Notice</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/tiledev/contacts.html">Contact Us</a>
      </li>

    </ul>
  </div>
</div><!--end of sub-nav-->

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" >
    Development Steps at Each Level
  </h1>

          <div id="js-quick-links" >
            <div class="quick-links"><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#components">Develop the Tile Generator Inputs</a></li>
<li><a href="#tile-generator">Describe and Generate Your Tile</a></li>
<li><a href="#deploy-tile">Deploy Your Generated BOSH Release and Full Tile</a></li>
<li>
<a href="#testing">Tile Testing</a><ul>
<li><a href="#pyramid">Tile Test Pyramid</a></li>
<li><a href="#smoke">Smoke Tests</a></li>
<li><a href="#general-recs">General Recommendations</a></li>
</ul>
</li>
</ul></div>
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <p>This topic describes the typical steps that tile developers follow when developing a tile at a given <a href="/tiledev/stages.html">integration level</a>,
such as brokered service tile, a managed service tile, or an on-demand service tile.</p>

<h2><a id="overview"></a> Overview</h2>

<p>The ultimate deliverable of a Pivotal Cloud Foundry (PCF) integration is almost always a <strong>tile</strong>, a
PCF installation package that is delivered through our
<a href="http://network.pivotal.io">Marketplace</a> and installed through Pivotal&rsquo;s
Ops Manager. But when developing an integration, it is advisable to start
with smaller components of that tile, as it allows you to iterate on those
components much faster. Pivotal recommends that you approach development in the following phases:</p>

<ol>
<li><a href="#components">Develop</a> and <a href="#testing">test</a> the Tile Generator inputs individually</li>
<li><a href="#tile-generator">Describe</a> your tile in <code>tile.yml</code> and use <a href="/tiledev/tile-generator.html">Tile Generator</a> to create the tile components</li>
<li>Test the generated deploy errands individually</li>
<li><a href="#deploy-tile">Deploy</a> and test the generated BOSH release and the complete tile</li>
<li><a href="#concourse">Implement</a> Continuous Integration (CI) for the complete tile</li>
</ol>

<p><img alt="Overview" src="img/tilegenerator.png" /></p>

<p>If you follow this approach, you may not have a dependency on a complete
PCF installation until step 3, and your iterations on the components will
be much faster than if you attempt to test them through actual deployment
to PCF.</p>

<p>Each of the development phases is described in more detail below.</p>

<h2><a id="components"></a> Develop the Tile Generator Inputs</h2>

<p>Tiles are a packaging format to deliver ISV software to PCF customers. Most
tiles contain one or more of the following types of components:</p>

<ul>
<li>Service Brokers</li>
<li>Managed Services</li>
<li>Buildpacks</li>
<li>Apps</li>
</ul>

<p>It is much more efficient to develop and test these components individually
than it is to test them through tile deployment. So before you start generating
and deploying tiles, <em>always</em> make sure that the components you are deploying
already work, individually and in whatever combination you intend to deploy
them as a tile.</p>

<p>In most cases, you do not need a full PCF installation to complete these early phases.
You can set up a <a href="/tiledev/environments.html#pcfdev">light-weight PCF development environment</a> on your laptop or desktop,
possibly including BOSH-Lite if your are developing managed services.</p>

<h2><a id="tile-generator"></a> Describe and Generate Your Tile</h2>

<p>After your components are in working order, download and install the
<a href="/tiledev/tile-generator.html">Tile Generator</a> and follow the instructions to describe
and generate your actual tile. This is where you list all the components that
are to be included, add an icon and a description, and have the option to add
forms for values that are to be configured by the PCF operator at installation
time.</p>

<h2><a id="deploy-tile"></a> Deploy Your Generated BOSH Release and Full Tile</h2>

<p>After you have verified that all individual <a href="#components">components</a> and
<a href="#test-errands">errands</a> work, you are ready to deploy your tile&rsquo;s generated BOSH release from the command line.</p>

<p>Finally, test deploy your tile as your customers would, by uploading it to Ops Manager, installing and configuring the tile,
and having Ops Manager apply your changes to the PCF deployment.</p>

<p>The only things you should be testing in this phase are the things that could not be tested in earlier ones:</p>

<ul>
<li>The appearance of the tile forms in Ops Manager</li>
<li>The upgrade/migration steps from one version of a tile to another (if applicable)</li>
</ul>

<p>Everything else should work exactly as it did in prior steps.</p>

<h2><a id="testing"></a> Tile Testing</h2>

<p>Good testing assures tile developers that their product installs and runs properly on diverse platforms,
and assures PCF platform operators that the tile they install can provide its service successfully on their platform.</p>

<p>Pivotal recommends a pyramid structure for testing, starting with unit tests and stepping up to successively broader and more automated levels of integration.
Pivotal uses and recommends <a href="/tiledev/concourse.html">Concourse</a> for creating build pipelines that follow this test structure.
Other continuous integration tools should also support a pyramid testing approach.</p>

<h3><a id="pyramid"></a> Tile Test Pyramid</h3>

<p>For PCF tiles, a typical test pyramid progresses as follows:</p>

<ol>
<li><p>Unit tests for each tile <strong>component</strong> (e.g. service components, broker, adapter, and metrics emitter), manual by developer and in automated pipeline.</p></li>
<li><p>System tests of the tile&rsquo;s <strong>BOSH release</strong>, including:</p>

<ul>
<li><strong>Functional tests</strong> covering the main features of the service.
The main features typically interact with almost all important external integration points, so these tests confirm product functionality.</li>
<li><strong>Smoke tests</strong> (lifecycle tests) for service instances that create and bind a service instance, call it from a test app,
check the logs it generates, and delete it.
For a typical end-to-end test sequence, see <a href="#smoke">Smoke Tests</a> below.</li>
</ul></li>
<li><p>System tests of <strong>tile</strong> operation within Ops Manager.</p>

<ul>
<li>These include:

<ul>
<li><strong>Configuration checks</strong> that test every external configurable integration point and connection to remote servers using configured credentials</li>
<li><strong>Default checks</strong> that confirm &ldquo;happy path&rdquo; functionality.</li>
</ul></li>
<li>Use the Ops Manager API to verify that property blueprints in the tile metadata are correct
and that they translate correctly to the BOSH manifest that Ops Manager generates.</li>
<li>Use the <a href="https://github.com/pivotal-cf/om">Om</a> tool to call the Ops Manager API programmatically from Go.
Avoid the unsupported opsmgr gem that called the Ops Manager API from Ruby.</li>
<li>Confirm manually that the tile wires property blueprints to the expected pane and form controls in the UI.</li>
</ul></li>
</ol>

<p class="note"><strong>Note</strong>: System tests might incur costs from using third party services, IaaS resources, etc.</p>

<h3><a id="smoke"></a> Smoke Tests</h3>

<p>Smoke tests are end-to-end lifecycle tests for service instances that you can include as <a href="/tiledev/tile-errands.html#post-deploy">post-deploy errands</a>
within a tile and also automate in <a href="/tiledev/concourse.html">Concourse</a> or other integration platforms.</p>

<p>A typical smoke test runs as follows:</p>

<ol>
<li><p>Create an org and space for the test to run in.</p></li>
<li><p>Register the tile&rsquo;s service broker.</p></li>
<li><p>Enable service access for the created org.</p></li>
<li><p>Iterate through all service plans (or a subset of them) to do the following:</p>

<ol>
<li>Create a service instance for the plan.</li>
<li>Push a test app.</li>
<li>Bind the service instance to the app.</li>
<li>Use the app in a way that exercises the service instance. For a data service, for example, write and read from the service instance.</li>
<li>Unbind the service instance.</li>
<li>Delete the service instance.</li>
<li>Delete the test app.</li>
</ol></li>
<li><p>Delete the service broker.</p></li>
<li><p>Delete the test org and space.</p></li>
</ol>

<h3><a id="general-recs"></a> General Recommendations</h3>

<p>The following are general recommendations for designing and running tests on PCF tiles:</p>

<ul>
<li><p>Clean up after yourself. Leave the environment exactly as it was before the test was run.</p></li>
<li><p>Generate verbose logging with lots of contextual data to make troubleshooting easier.</p></li>
<li><p>Design test suites for re-usability by making them highly parameterizable. Important parameters include:</p>

<ul>
<li>External settings such as domains, creds, and certs</li>
<li>Plans to test against.
For example, the <a href="https://github.com/pivotal-cf/cf-redis-smoke-tests">Redis for PCF</a> smoke tests use identical code
for two different service plans, pre-provisioned and on-demand.</li>
<li>Timeouts, numbers of retries, and other things that you need to adjust for different environments</li>
<li>Switches to include or exclude portions of the tests such as generating metrics or backups</li>
</ul></li>
<li><p>Re-use tests that exist already, for example in Concourse.</p></li>
<li><p>Use an example CF app that uses your service. This app can serve for testing, demoing your tile capabilities, and as a code code example.
See the <a href="https://github.com/cloudfoundry-incubator/cf-mysql-acceptance-tests/tree/master/assets/sinatra_app">MySQL Test App</a> an example.</p></li>
<li><p>When testing manually, using the UI is better than calling the underlying API directly.
Use UIs and APIs the way a customer would.</p></li>
</ul>

        <div><a id='repo-link' href='http://github.com/pivotal-cf/docs-tiledev/tree/master/development.html.md.erb'>View the source for this page in GitHub</a></div>

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
  <a href='https://pivotal.io/privacy-policy'>Privacy Policy</a> | 
  <a href='https://pivotal.io/terms-of-use'>Terms of Use</a><br/>
  <a href='/'>Pivotal Documentation</a>
  &copy; 2017 <a href='https://pivotal.io'>Pivotal Software</a>, Inc. All Rights Reserved.
</div>
<div class="support">
  Need help? <a href="" target="_blank">Visit Support</a>
</div>

  </footer>
</div><!--end of container-->

</body>
</html>
