<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      pcf Command Line Utility |
    
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  
<script type="text/javascript">
  if (window.location.host === 'docs.pivotal.io') {
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', '']);
    _gaq.push(['_setDomainName', '']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();
  }
</script>

<script type="text/javascript">
  var blackList = ['acceptance'];

  blackList.forEach(function(blackListedEnv) {
    if (document.URL.indexOf(blackListedEnv) > -1 && blackListedEnv != "") {
      $('head').append('<meta name="hashtag" content="PivotalMoment">');
    }
  });
</script>

<!-- CrazyEgg Tracking Script -->
  <script type="text/javascript">
  setTimeout(function(){var a=document.createElement("script");
  var b=document.getElementsByTagName("script")[0];
  a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0055/2990.js?"+Math.floor(new Date().getTime()/3600000);
  a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>

<!-- Munchkin Marketo Script -->
<script type="text/javascript">
  (function() {
    var didInit = false;

    function initMunchkin() {
      if (didInit === false) {
        didInit = true;
        Munchkin.init('625-IUJ-009');
      }
    }

    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
      if (this.readyState == 'complete' || this.readyState == 'loaded') {
        initMunchkin();
      }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
  })();
</script>

</head>

<body class="tiledev tiledev_2-0 tiledev_2-0_pcf-command has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "";
    </script>

       
    <header class="header header-layout">
      <h1 class="logo">
        <a href="/">Default Book Title</a>
      </h1>
      
      <div class="header-links js-bar-links">
        <div class="btn-menu" data-behavior="MenuMobile"></div>
        
        <div class="header-item">
          
        </div>
        <!--Default search-->
<!--If book needs something different, add a book-search partial to the book's layouts folder-->
<div class="header-item searchbar js-searchbar">
  <a class="search-icon" data-behavior="Search"></a>
  <div class="search-input">
    <div class="search-input-inner" id="docs-search">
        <form method="get" action="/search">
          <input name="q" placeholder="search" class="search-box" />
        </form>
    </div>
  </div>
</div>

      </div>
    </header>



    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="js-sidenav nav-container" role="navigation">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    <ul>

      <li>
        <a href="index.html">PCF Tile Developers Guide</a>
      </li>

      <li class="has_submenu">
        <a href="tile-basics.html">Tile Basics</a>
        <ul>
          <li>
            <a href="cf-concepts.html">How PCF and PCF Services Work</a>
          </li>
          <li>
            <a href="tile-structure.html">How Tiles Work</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <a href="workflow.html">Tile Development Workflow</a>
        <ul>
          <li>
            <a href="overview.html">Service Integration Overview</a>
          </li>
          <li>
            <a href="stages.html">Levels of Integration</a>
          </li>
          <li>
            <a href="development.html">Development Steps at Each Level</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <a href="environments.html">Development Environments</a>
        <ul>
          <li>
            <a href="environments.html#pcfdev">PCF Dev and BOSH Lite</a>
          </li>
          <li>
            <a href="environments.html#pws">PWS or Other Supported CF Infrastructure</a>
          </li>
          <li>
            <a href="environments.html#pcf">PCF with Ops Manager</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <a href="tools.html">Development Tools</a>
        <ul>
          <li>
            <a href="tile-generator.html">Tile Generator</a>
          </li>
          <li>
            <a href="pcf-command.html">pcf Command Line Utility</a>
          </li>
          <li>
            <a href="concourse.html">Concourse CI</a>
          </li>
          <li>
            <a href="sdk.html">Services SDK</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu expanded">
        <a href="roadmap.html">Service Development Roadmap</a>
        <ul>
          <li>
            <a href="roadmap.html#user-provided">Level 1: User-Provided Service</a>
          </li>
          <li class="has_submenu">
            <a href="brokered.html">Level 2: Brokered Service</a>
            <ul>
              <li>
                <a href="service-brokers.html">Service Broker</a>
              </li>
            </ul>
           </li> 
          <li class="has_submenu">
            <a href="managed.html">Level 3: Managed Service</a>
            <ul>
              <li>
                <a href="bosh-release.html">BOSH Releases</a>
              </li>
              <li>
                <a href="tile-errands.html">Errands</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="on-demand.html">Level 4: On-Demand Service</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <a href="other-integrations.html">Other Integrations</a>
        <ul>
          <li>
            <a href="https://github.com/cloudfoundry/docs-bbr/blob/master/bbr-devguide.html.md.erb">BOSH Backup and Restore</a>
          </li>
          <li>
            <a href="buildpacks.html">Buildpacks</a>
          </li>
          <li class="has_submenu">
            <a href="credhub.html">CredHub</a>
            <ul>
              <li>
                <a href="create-credhub-vars.html">Creating New Variables in CredHub</a>
              </li>
              <li>
                <a href="migrating-credhub-credentials.html">Migrating Existing Credentials to CredHub</a>
              </li>
              <li>
                <a href="get-credhub-vars.html">Fetching Variable Names and Values</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="embedded-agents.html">Embedded Agents</a>
          </li>
          <li>
            <a href="nozzle.html">Logs, Metrics, and Nozzles</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="tile-documentation.html">Documentation</a>
      </li>

      <li class="has_submenu">
        <a href="publish.html">Publish and Update</a>
        <ul>
          <li>
            <a href="tile-upgrades.html">Tile Upgrades</a>
          </li>
          <li>
            <a href="releases.html">Partner Software Product Release Cycle</a>
          </li>
        </ul>
      </li>


      <li class="has_submenu">
        <a href="reference.html">Reference</a>
        <ul>
          <li>
            <a href="product-template-reference.html">Product Template Reference</a>
          </li>
          <li>
            <a href="property-reference.html">Property Reference</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
        <a href="release-notes.html">Partners Release Notices</a>
        <ul>
          <li>
            <a href="release-notes-1-12.html">PCF v1.12 Partners Release Notice</a>
          </li>
          <li>
            <a href="release-notes-1-11.html">PCF v1.11 Partners Release Notice</a>
          </li>
          <li>
            <a href="release-notes-1-10.html">PCF v1.10 Partners Release Notice</a>
          </li>
          <li>
            <a href="release-notes-1-9.html">PCF v1.9 Partners Release Notice</a>
          </li>
          <li>
            <a href="release-notes-1-8.html">PCF v1.8 Partners Release Notice</a>
          </li>
          <li>
            <a href="release-notes-1-7.html">PCF v1.7 Partners Release Notice</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="contacts.html">Contact Us</a>
      </li>

    </ul>
  </div>
</div><!--end of sub-nav-->

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" >
    pcf Command Line Utility
  </h1>

          <div id="js-quick-links" >
            <div class="quick-links"><ul>
<li><a href="#install">Installation</a></li>
<li><a href="#auth">Authentication</a></li>
<li><a href="#commands">Commands</a></li>
<li><a href="#ops-man-settings">Checking Ops Manager Settings</a></li>
<li><a href="#deploy-tiles">Deploying Tiles</a></li>
<li><a href="#remove">Removing Tiles</a></li>
<li><a href="#access-ert">Accessing Elastic Runtime</a></li>
</ul></div>
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <p>The <code>pcf</code> utility provides a command line interface to Pivotal Cloud Foundry for
the purpose of deploying and testing tiles. Its primary reason for existence is
to enable Ops Manager access from CI pipelines, but developers also find it
convenient to use this CLI rather than the Ops manager GUI.</p>

<p>The <code>pcf</code> utility also allows you to test your tile&rsquo;s BOSH errands
directly from your CLI, without going through Ops Manager and BOSH. This greatly
reduces the time it takes to deploy/test each iteration of your software components.</p>

<h2><a id="install"></a> Installation</h2>

<p>The <code>pcf</code> utility comes bundled with the Tile Generator tool. To
install the <code>pcf</code> utility, follow the
<a href="/tiledev/2-0/tile-generator.html#how-to">Tile Generator installation instructions</a>.</p>

<h2><a id="auth"></a> Authentication</h2>

<p>The <code>pcf</code> utility looks for a file called <code>metadata</code> in the current directory.
This file is expected to provide the URL and credentials to connect to
Ops Manager, in the following format:</p>
<pre class="highlight yaml"><code><span class="nn">---</span>
<span class="s">opsmgr</span><span class="pi">:</span>
    <span class="s">url</span><span class="pi">:</span> <span class="s">https://opsmgr.example.com</span>
    <span class="s">username</span><span class="pi">:</span> <span class="s">admin</span>
    <span class="s">password</span><span class="pi">:</span> <span class="s">&lt;redacted&gt;</span>
</code></pre>

<p>The reason for this file naming is because this is how Concourse passes
credentials of a &ldquo;claimed&rdquo; PCF pool resource to the CI pipeline scripts.
For interactive use, this means that you will have to create a <code>metadata</code>
file in the directory where you run the <code>pcf</code> command.</p>

<p class='note'>Pivotal recommends that you do <strong>not</strong> create this file inside your git or other version control system repository, as you do not want to accidentally commit these credentials to version control.</p>

<h2><a id="commands"></a> Commands</h2>

<p>The <code>pcf</code> utility implements many different commands. To see available commands:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf --help
Usage: pcf <span class="o">[</span>OPTIONS] COMMAND <span class="o">[</span>ARGS]...

Options:
  --help  Show this message and exit.

Commands:
  apply-changes
  cf-info
  changes
  configure
  delete-unused-products
  import
  install
  is-available
  is-installed
  logs
  products
  settings
  target
  <span class="nb">test</span>-errand
  uninstall
</code></pre>

<h2><a id="ops-man-settings"></a> Checking Ops Manager Settings</h2>

<p>To see which products are currently available and installed in Ops Manager:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf products
- p-bosh 1.7.0.0 <span class="o">(</span>installed<span class="o">)</span>
- cf 1.7.0-build.258 <span class="o">(</span>installed<span class="o">)</span>
- <span class="nb">test</span>-tile 0.3.95
</code></pre>

<p>To test if a specific product is available or installed from within a script:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf is-available <span class="nb">test</span>-tile <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"Product test-tile is available"</span>
<span class="gp">$ </span>pcf is-installed <span class="nb">test</span>-tile <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"Product test-tile is installed"</span>
</code></pre>

<p>You can retrieve the settings for a specific product (this will give you a <em>lot</em> of json):</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf settings <span class="nb">test</span>-tile
<span class="o">{</span>
    <span class="s2">"network_reference"</span>: <span class="s2">"669e213111ab5aa1008a"</span>,
    <span class="s2">"guid"</span>: <span class="s2">"test-tile-be3e50cf26c530acca6e"</span>,
    <span class="s2">"jobs"</span>: <span class="o">[</span>
        <span class="o">{</span>
            <span class="s2">"instance"</span>: <span class="o">{</span>
                <span class="s2">"identifier"</span>: <span class="s2">"instances"</span>
            <span class="o">}</span>,
            <span class="s2">"identifier"</span>: <span class="s2">"compilation"</span>,
            <span class="s2">"guid"</span>: <span class="s2">"compilation-066a85d82fbcd936f9d7"</span>,
            <span class="s2">"installation_name"</span>: <span class="s2">"compilation"</span>,
            <span class="s2">"vm_credentials"</span>: <span class="o">{</span>
                <span class="s2">"password"</span>: &lt;redacted&gt;,
                <span class="s2">"salt"</span>: &lt;redacted&gt;,
                <span class="s2">"identity"</span>: <span class="s2">"vcap"</span>
            <span class="o">}</span>
        <span class="o">}</span>,
        <span class="o">{</span>
            <span class="s2">"guid"</span>: <span class="s2">"deploy-all-b83a7cb7be00ebfd26d6"</span>,
            <span class="s2">"vm_credentials"</span>: <span class="o">{</span>
    ...
</code></pre>

<h2><a id="deploy-tiles"></a> Deploying Tiles</h2>

<p>After your software works and correctly deploys using <code>test-errand</code>, you can go
through the real Ops Manager deployment process from the CLI, as you would
normally do through the Ops Manager GUI.</p>

<p>Import your .pivotal file into Ops Manager:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf import sample/product/test-tile-0.0.2.pivotal
</code></pre>

<p>Install the uploaded version of your product:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf install <span class="nb">test</span>-tile 0.0.2
</code></pre>

<p>Where you would normally configure the tile settings in the GUI, the <code>configure</code>
command lets you pass in any user-specified properties as a .yml file. This command
also sets the stemcell for the tile to the same one used by your Elastic Runtime,
to avoid the need to upload a tile-specific stemcell.</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf configure <span class="nb">test</span>-tile sample/missing-properties.yml
- Using stemcell bosh-vsphere-esxi-ubuntu-trusty-go_agent version 3215
</code></pre>

<p>The property file looks like this:</p>
<pre class="highlight yaml"><code><span class="nn">---</span>
<span class="s">customer_name</span><span class="pi">:</span> <span class="s">Jimmy's Johnnys</span>
<span class="s">street_address</span><span class="pi">:</span> <span class="s">Cartaway Alley</span>
<span class="s">city</span><span class="pi">:</span> <span class="s">New Jersey</span>
<span class="s">country</span><span class="pi">:</span> <span class="s">US</span>
<span class="s">username</span><span class="pi">:</span> <span class="s">SpongeBob</span>
<span class="s">password</span><span class="pi">:</span> <span class="pi">{</span> <span class="s1">'</span><span class="s">secret'</span><span class="pi">:</span> <span class="nv">Square'Pants</span> <span class="pi">}</span>
<span class="s">app2</span><span class="pi">:</span>
  <span class="s">persistence_store_type</span><span class="pi">:</span> <span class="s">none</span>
<span class="c1"># In PCF 1.8+, BOSH-job-specific configuration is supported:</span>
<span class="s">jobs</span><span class="pi">:</span>
  <span class="s">a_job</span><span class="pi">:</span>
    <span class="c1"># Job resource configuration:</span>
    <span class="s">resource_config</span><span class="pi">:</span>
      <span class="s">persistent_disk</span><span class="pi">:</span>
        <span class="s">size_mb</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10240"</span>
    <span class="c1"># Job-specific property configuration:</span>
    <span class="s">job_property</span><span class="pi">:</span> <span class="s">property_value</span>
</code></pre>

<p>You must define any <code>secret</code> type property value as a hash, in curly brackets. Specifying a simple
string value for a field of this type results in a <code>500 System Error</code> being returned from <code>pcf configure</code>. 
The <code>secret</code> type property values can contain special characters.</p>

<p>To see what changes are ready to be applied:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf changes
install: <span class="nb">test</span>-tile-207b165fcb7dc8b2597b
delete:  
</code></pre>

<p>To apply these changes:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf apply-changes
  <span class="o">=====</span> 2016-04-21 18:45:05 UTC Running <span class="s2">"bosh-init deploy /var/tempest/workspaces/default/deployments/bosh.yml"</span>
  Deployment manifest: <span class="s1">'/var/tempest/workspaces/default/deployments/bosh.yml'</span>
  Deployment state: <span class="s1">'/var/tempest/workspaces/default/deployments/bosh-state.json'</span>

  Started validating
    Validating release <span class="s1">'bosh'</span>... Finished <span class="o">(</span>00:00:08<span class="o">)</span>
    Validating release <span class="s1">'bosh-vsphere-cpi'</span>... Finished <span class="o">(</span>00:00:00<span class="o">)</span>
    Validating release <span class="s1">'uaa'</span>... Finished <span class="o">(</span>00:00:06<span class="o">)</span>
    Validating cpi release... Finished <span class="o">(</span>00:00:00<span class="o">)</span>
    Validating deployment manifest... Finished <span class="o">(</span>00:00:00<span class="o">)</span>
</code></pre>

<p><code>pcf apply-changes</code> automatically tails the logs for the installation process
it started. If this gets aborted for any reason, you can always tail the logs
of the most recent installation:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf logs
</code></pre>

<h2><a id="remove"></a> Removing Tiles</h2>

<p>To uninstall a tile:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf uninstall <span class="nb">test</span>-tile
</code></pre>

<p>If you accumulate a lot of uninstalled tiles or old versions, you can clean
up Ops Manager&rsquo;s available products (and disk space):</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf delete-unused-products
</code></pre>

<h2><a id="access-ert"></a> Accessing Elastic Runtime</h2>

<p>To see details about the Elastic Runtime of your PCF environment:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf cf-info
- admin_password: &lt;redacted&gt;
- admin_username: admin
- apps_domain: cfapps-04.example.com
- system_domain: run-04.example.com
- system_services_password: &lt;redacted&gt;
- system_services_username: system_services
</code></pre>

<p>To target your <code>cf</code> command line at this PCF environment:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pcf target
Setting api endpoint to api.example.com...
OK

API endpoint:   https://api.example.com <span class="o">(</span>API version: 2.52.0<span class="o">)</span>   
User:           admin   
Org:            my-org
Space:          my-space
API endpoint: https://api.example.com
Authenticating...
OK

...
</code></pre>

        <div><a id='repo-link' href='http://github.com/pivotal-cf/docs-tiledev/tree/master/pcf-command.html.md.erb'>View the source for this page in GitHub</a></div>

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
  <a href='https://pivotal.io/privacy-policy'>Privacy Policy</a> | 
  <a href='https://pivotal.io/terms-of-use'>Terms of Use</a><br/>
  <a href='/'>Pivotal Documentation</a>
  &copy; 2017 <a href='https://pivotal.io'>Pivotal Software</a>, Inc. All Rights Reserved.
</div>
<div class="support">
  Need help? <a href="" target="_blank">Visit Support</a>
</div>

  </footer>
</div><!--end of container-->

</body>
</html>
